              <!-- modal -->
              <div class="row">
                <div class="col-12">
                  <div class="card">
                    <div class="card-header">
                      <h3 class="card-title">Qu·∫£n l√Ω kh√°ch h√†ng</h3>

                      <form action="/admin/customer" method="GET" class="form-inline justify-content-end">
                        <label class="mr-2">T√¨m ki·∫øm:</label>
                        <input type="search" name="search" class="form-control mr-2" value="<%= search || '' %>">

                        <label class="mr-2">Ph√¢n lo·∫°i:</label>
                        <select name="tier" class="form-control mr-2">
                          <option value="">T·∫•t c·∫£</option>
                          <option value="ƒê·ªìng" <%= tier === 'ƒê·ªìng' ? 'selected' : '' %>>ü•â ƒê·ªìng</option>
                          <option value="B·∫°c" <%= tier === 'B·∫°c' ? 'selected' : '' %>>ü•à B·∫°c</option>
                          <option value="V√†ng" <%= tier === 'V√†ng' ? 'selected' : '' %>>ü•á V√†ng</option>
                        </select>

                        <button class="btn btn-danger" type="submit">L·ªçc</button>
                      </form>

                    </div>

                    <!-- /.card-header -->
                    <div class="card-body table-responsive p-0">
                      <table class="table table-hover text-nowrap">
                        <thead>
                          <tr>
                            <th>ID</th>
                            <th>T√™n</th>
                            <th>S·ªë ƒëi·ªán tho·∫°i</th>
                            <th>Email</th>
                            <th>T√™n ng∆∞·ªùi nh·∫≠n</th>
                            <th>S·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi nh·∫≠n</th>
                            <th>S·ªë nh√†, ƒë∆∞·ªùng</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th></th>
                            <th></th>
                          </tr>
                        </thead>

                        <tbody>
                          <% for (const customer of customers){ %>
                          <% 
  let tierClass = 'badge-secondary', tier = 'ü•â ƒê·ªìng';
  if (customer.totalOrders >= 10 || customer.totalSpent >= 16000000) {
    tier = 'ü•á V√†ng';
    tierClass = 'badge-warning'; 
  } else if (customer.totalOrders >= 5) {
    tier = 'ü•à B·∫°c';
    tierClass = 'badge-info';
  }
%>
                          <tr data-widget="expandable-table" aria-expanded="false">
                            <td><%= customer.id %></td>
                            <td>
                              <%= customer.name %>
                              <span class="badge <%= tierClass %>"><%= tier %></span>
                            </td>
                            <td><%= customer.mobile %></td>
                            <td><%= customer.email %></td>
                            <td><%= customer.shipping_name %></td>
                            <td><%= customer.shipping_mobile %></td>
                            <td><%= customer.housenumber_street %></td>
                            <td><%= customer.is_active == '1' ? 'Ho·∫°t ƒë·ªông' : 'Kh√¥ng ho·∫°t ƒë·ªông' %></td>
                            <td><a class="btn btn-info btn-block" href="/admin/customer/edit/<%= customer.id %>/">S·ª≠a</a></td>
                            <td>
                              <button data-href="/admin/customer/destroy/<%= customer.id %>" type="button" class="btn btn-danger btn-block destroy" data-toggle="modal" data-target="#exampleModal">X√≥a</button>
                            </td>
                          </tr>

                          <tr class="expandable-body bg-light">
                            <td colspan="10">
                              <p><strong>T·ªïng s·ªë ƒë∆°n h√†ng: <%= customer.totalOrders %></strong></p>
                              <p><strong>T·ªïng chi ti√™u:</strong> <%= helpers.formatMoney(customer.totalSpent) %>‚Ç´</p>

                              <% if (customer.lastOrderDate) { %>
                              <p>üïí ƒê∆°n h√†ng g·∫ßn nh·∫•t: <%= customer.lastOrderDate %></p>
                              <% } else { %>
                              <small class="text">‚ùå Ch∆∞a c√≥ ƒë∆°n h√†ng</small>
                              <% } %>

                              <% if (customer.orders.length === 0) { %>
                              <p>Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o.</p>
                              <% } else { %>
                              <% for (const order of customer.orders) { %>

                              <div class="mb-3 p-2 border border-secondary rounded bg-white shadow-sm">
                                <strong>ƒê∆°n h√†ng #<%= order.id %> - Ng√†y: <%= order.created_date %></strong>
                                <div class="table-responsive">
                                  <table class="table table-bordered mt-2">
                                    <thead>
                                      <tr>
                                        <th>H√¨nh ·∫£nh s·∫£n ph·∫©m</th>
                                        <th>T√™n s·∫£n ph·∫©m</th>
                                        <th>S·ªë l∆∞·ª£ng</th>
                                        <th>ƒê∆°n gi√°</th>
                                        <th>Th√†nh ti·ªÅn</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <% for (const orderItem of order.orderItems) {
                                                 const product = orderItem.product;
                                            %>
                                      <tr>
                                        <td><img src="/images/<%= product.featured_image %>" style="width: 60px;"></td>
                                        <td><%= product.name %></td>
                                        <td><%= orderItem.qty %></td>
                                        <td><%= helpers.formatMoney(orderItem.unit_price) %>‚Ç´</td>
                                        <td><%= helpers.formatMoney(orderItem.total_price) %>‚Ç´</td>
                                      </tr>
                                      <% } %>
                                    </tbody>
                                  </table>
                                </div>
                                <div class="summary">
                                  <p><strong>T·∫°m t√≠nh:</strong> <%= helpers.formatMoney(order.total_price) %>‚Ç´</p>
                                  <p><strong>Ph√≠ v·∫≠n chuy·ªÉn:</strong> <%= helpers.formatMoney(order.shipping_fee) %>‚Ç´</p>
                                  <p><strong>T·ªïng c·ªông:</strong> <%= helpers.formatMoney(order.total_price + order.shipping_fee) %>‚Ç´</p>
                                </div>
                              </div>
                              <% } %>
                              <% } %>
                            </td>
                          </tr>
                          <% } %>
                        </tbody>

                      </table>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Paging -->
              <%- include('../pagination') %>
              <!-- End paging -->

              <!-- Button trigger modal -->
              <!-- Modal -->
              <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">B·∫°n ch·∫Øc l√† mu·ªën x√≥a?</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Kh√¥ng</button>
                      <a type="button" class="btn btn-primary">C√≥</a>
                    </div>
                  </div>
                </div>
              </div>